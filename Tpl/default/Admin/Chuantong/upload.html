<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="__PUBLIC__/layui/css/layui.css">
<style type="text/css">
body{
	padding:10px;
}
.layui-upload-img{
	width:190px;
	height:120px;
}
</style>
</head>
<body class="layui-layout-body" >
<div class="layui-fluid">
	<div class="layui-col-sm9  layui-col-sm-offset1">
	<form class="layui-form" action="" id="form1">
		<br>	
		<div class="layui-form-item">
		  <button type="button" class="layui-btn layui-btn-normal" id="test8">选择文件</button>
		</div>
		
		<br>
		<div class="layui-form-item">
	 	    <div class="layui-progress layui-progress-big" lay-showPercent="yes" lay-filter="progressBar">
				<div class="layui-progress-bar layui-bg-red" lay-percent="0%"></div>
			</div>
		</div>
			  
	  <br>
	  <div class="layui-form-item">
	    <div class="layui-input-block" style="text-align: center;">
	    	<button type="button" class="layui-btn" id="test9">开始上传</button>
	    </div>
	  </div>
	  
  </form>
  <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
    <legend>进度显示</legend>
  </fieldset>
  <ul class="layui-timeline">
    <li class="layui-timeline-item">
      <i class="layui-icon layui-timeline-axis"></i>
      <div class="layui-timeline-content layui-text">
        <h3 class="layui-timeline-title">文件开始上传</h3>
        <p>
          上传成功 
        </p>
      </div>
    </li>
  </ul>  
  </div>
  
</div>
<script src="__PUBLIC__/js/jquery.min.js"></script>
<script src="__PUBLIC__/layui/layui.all.meeting.js"></script>
<script>
var id="{$d_id}"; //稿件id
window.onload=function(){
	upload = layui.upload;
	element = layui.element;
	element.init();
	//选完文件后不自动上传
	upload.render({
	    elem: '#test8'
	    ,url: '/index.php/Document/document_add_attachment_handler'
	    ,auto: false
	    ,accept:"file"
	    ,bindAction: '#test9'
	    ,progress: function(e , percent){
			element.progress('progressBar',percent  + '%');
		 }
	    ,done: function(res){
		      parent.layer.msg(res.msg);	
		      if(res.code==0){
			  	window.location.reload();
			  }
	    }
   });
}
</script>
</body>
</html>